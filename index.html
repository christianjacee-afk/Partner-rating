<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TiffanyTinx Ratings</title>

<link href="https://fonts.googleapis.com/css2?family=Metal+Mania&family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
body{
  background:radial-gradient(circle at top,#2b0000,#000);
  color:#eee;
  font-family:'Cinzel',serif;
  padding:20px;
}
.container{
  max-width:820px;
  margin:auto;
  background:rgba(15,15,15,.95);
  padding:30px;
  border-radius:28px;
  border:3px solid #ff3b3b;
  box-shadow:0 0 30px rgba(255,0,0,.7);
}
h1{
  font-family:'Metal Mania',cursive;
  text-align:center;
  font-size:4.8em;
  color:#ff3b3b;
  text-shadow:0 0 20px red;
}
label{margin-top:16px;display:block;color:#ffb3b3}
input,select,textarea{
  width:100%;
  padding:12px;
  background:#1b1b1b;
  border:2px solid #ff3b3b;
  color:#fff;
  border-radius:20px;
}
#saveBtn{
  margin-top:25px;
  padding:18px;
  width:100%;
  border:none;
  border-radius:35px;
  background:linear-gradient(#ff5555,#990000);
  font-size:1.3em;
  font-weight:bold;
  color:#000;
  cursor:pointer;
  box-shadow:0 10px #550000,0 0 30px red;
}
#saveBtn:active{transform:translateY(10px);box-shadow:none}

.rating{
  margin-top:22px;
  padding:18px;
  border-radius:22px;
  background:#222;
  border:2px solid #ff3b3b;
  box-shadow:0 0 15px rgba(255,0,0,.4);
}
.stars{color:gold;font-size:1.2em}

.secret-toggle{
  position:fixed;
  bottom:20px;
  width:60px;height:60px;
  border-radius:50%;
  background:#ff3b3b;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:1.6em;
  cursor:pointer;
  box-shadow:0 0 25px red;
}
#adminToggle{right:20px}
#tinxToggle{right:90px;background:#ff66cc}

.panel{
  position:fixed;
  bottom:95px;
  right:20px;
  background:#2a0000;
  padding:18px;
  border-radius:20px;
  border:2px solid #ff3b3b;
  display:none;
  width:260px;
}
button{
  margin-top:10px;
  padding:10px;
  border:none;
  border-radius:18px;
  background:#ff3b3b;
  font-weight:bold;
  cursor:pointer;
}

/* ðŸ”¥ FULLSCREEN FLAME */
.flame{
  position:fixed;
  inset:0;
  z-index:9999;
  background:radial-gradient(circle at 50% 85%,#fff,#ff0,#ff4500,#8b0000,transparent);
  animation:rise 2s ease-out forwards;
}
@keyframes rise{
  from{opacity:0;transform:translateY(100%)}
  25%{opacity:1}
  to{opacity:0;transform:translateY(-100%)}
}
</style>
</head>

<body>

<div class="container">
<h1>TiffanyTinx</h1>

<label>Name</label>
<input id="name" placeholder="Anonymous">

<label>Character</label>
<select id="character">
  <option value="Pim">Pim</option>
  <option value="Charlie">Charlie</option>
  <option value="Glep">Glep</option>
  <option value="Mr Boss">Mr Boss</option>
</select>

<label>Stars</label>
<select id="stars">
  <option value="1">1</option><option value="2">2</option>
  <option value="3">3</option><option value="4">4</option>
  <option value="5">5</option>
</select>

<label>PP Energy</label>
<select id="pp">
  <option value="1">1</option><option value="2">2</option>
  <option value="3">3</option><option value="4">4</option>
  <option value="5">5</option><option value="6">6</option>
  <option value="7">7</option><option value="8">8</option>
  <option value="9">9</option><option value="10">10</option>
</select>

<label>Comment</label>
<textarea id="review"></textarea>

<button id="saveBtn"><i class="fas fa-heart"></i> SAVE RATING</button>

<div id="list"></div>
</div>

<!-- TOGGLES -->
<div id="adminToggle" class="secret-toggle"><i class="fas fa-anchor"></i></div>
<div id="tinxToggle" class="secret-toggle"><i class="fas fa-gift"></i></div>

<!-- PANELS -->
<div id="adminPanel" class="panel">
  <label>Admin Password</label>
  <input type="password" id="adminPass">
  <button id="adminLogin">Login</button>
  <p id="adminStatus"></p>
</div>

<div id="tinxPanel" class="panel" style="right:90px">
  <label>Tinx Password</label>
  <input type="password" id="tinxPass">
  <button id="tinxLogin">Login</button>
  <p id="tinxStatus"></p>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey:"AIzaSyC7srqV5cigcYZEdGIW5O8jl-LoA5nNECk",
  authDomain:"tiffanytinx-bbf9c.firebaseapp.com",
  databaseURL:"https://tiffanytinx-bbf9c-default-rtdb.firebaseio.com",
  projectId:"tiffanytinx-bbf9c"
});

const db=firebase.database();
const ref=db.ref("ratings");

const ADMIN_PASSWORD="ppeanile";
const TINX_PASSWORD="tinxrules";
let isAdmin=false,isTinx=false;

adminToggle.onclick=()=>adminPanel.style.display=adminPanel.style.display==="block"?"none":"block";
tinxToggle.onclick=()=>tinxPanel.style.display=tinxPanel.style.display==="block"?"none":"block";

adminLogin.onclick=()=>{
  if(adminPass.value===ADMIN_PASSWORD){
    isAdmin=true;
    adminStatus.textContent="Admin enabled";
    render();
  }
};

tinxLogin.onclick=()=>{
  if(tinxPass.value===TINX_PASSWORD){
    isTinx=true;
    tinxStatus.textContent="Tinx enabled";
    render();
  }
};

function flame(){
  const f=document.createElement("div");
  f.className="flame";
  document.body.appendChild(f);
  setTimeout(()=>f.remove(),2000);
}

saveBtn.onclick=()=>{
  const s=parseInt(stars.value);
  ref.push({
    name:name.value||"Anonymous",
    character:character.value,
    stars:s,
    pp:parseInt(pp.value),
    review:review.value,
    token:s===5,
    claimed:false,
    time:Date.now()
  });
  if(s===5) flame();
  name.value="";review.value="";
};

window.del=id=>isAdmin&&confirm("Delete?")&&ref.child(id).remove();
window.claim=id=>isTinx&&ref.child(id).update({claimed:true});
window.unclaim=id=>isTinx&&ref.child(id).update({claimed:false});

window.editRating=(id,r)=>{
  if(!isAdmin) return;
  const n=prompt("Name:",r.name)||r.name;
  const c=prompt("Character:",r.character)||r.character;
  const s=parseInt(prompt("Stars:",r.stars))||r.stars;
  const p=parseInt(prompt("PP:",r.pp))||r.pp;
  const rev=prompt("Comment:",r.review)||r.review;
  ref.child(id).update({name:n,character:c,stars:s,pp:p,review:rev});
};

function render(){
  ref.limitToLast(25).once("value",snap=>{
    list.innerHTML="";
    snap.forEach(c=>{
      const r=c.val();
      const d=document.createElement("div");
      d.className="rating";
      d.innerHTML=`
<b>${r.name}</b> (${r.character})<br>
<span class="stars">${"â˜…".repeat(r.stars)}</span><br>
PP: ${r.pp}<br>
${r.review||""}<br>
${r.token?`ðŸŽŸ Token: ${r.claimed?"CLAIMED":"UNCLAIMED"}
${isTinx?`<button onclick="${r.claimed?"unclaim":"claim"}('${c.key}')">${r.claimed?"Unclaim":"Claim"}</button>`:""}`:""}
${isAdmin?`
<br>
<button onclick="editRating('${c.key}',${JSON.stringify(r).replace(/"/g,'&quot;')})">Edit</button>
<button onclick="del('${c.key}')">Delete</button>`:""}
`;
      list.prepend(d);
    });
  });
}
ref.on("value",render);
</script>

</body>
</html>
